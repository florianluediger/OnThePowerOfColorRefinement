\section{Globale Struktur von CR-Graphen}
\label{sec/struktur_global}

%\begin{itemize}
%	\item Erklärung der globalen Struktur zugänglicher Graphen (C,D,E,F,G,H)
%	\item Ansonten wie Kapitel \ref{sec/struktur_lokal}
%\end{itemize}

Zusätzlich zur lokalen Struktur ist außerdem die globale Struktur von CR-Graphen interessant.
Der Begriff \enquote{globale Struktur} gibt hier an, dass der Zellgraph von $G$ bestimmte Eigenschaften erfüllen muss.

\begin{Definition}
	Der Zellgraph $C(G)$ eines Graphen $G$ wird aus dessen stabilen Partition $\mathcal{P}_G$ gebildet.
	Es handelt sich dabei um einen vollständigen Graphen, bei dem die Knoten die Zellen von $\mathcal{P}_G$ darstellen.
\end{Definition}

\subsection{Mögliche Eigenschaften von Zellgraphen}
Für das Verständnis der folgenden Eigenschaften von CR-Graphen ist es erforderlich einige Begriffe einzuführen und Eigenschaften von Zellgraphen zu erklären und zu benennen, wozu einige Definitionen folgen.
Die Knoten eines Zellgraphen, auch als Zellen bezeichnet, können dabei folgende Eigenschaften aufweisen.

\begin{Definition}
	Eine Zelle $X\in C(G)$ wird \emph{homogen} genannt, wenn der Graph $G[X]$ vollständig oder leer ist. Anderenfalls wird diese \emph{heterogen} genannt.
\end{Definition}

\begin{Definition}
	Für eine heterogene Zelle $X\in C(G)$ finden sich je nach Beschaffenheit von $G[X]$ die Bezeichnungen \emph{matching}, \emph{co-matching} oder \emph{pentagonal}.
	Eine homogene Zelle wird dagegen entweder \emph{leer} oder \emph{vollständig} genannt.
\end{Definition}

Für die Kanten eines Zellgraphen finden sich ebenfalls unterschiedliche Bezeichnungen, welche deren Beschaffenheit beschreiben.

\begin{Definition}
	Eine Kante $\{X,Y\}$ mit $X,Y\in C(G)$ wird \emph{isotrop} genannt, wenn der bipartite Graph $G[X,Y]$ vollständig oder leer ist. Anderenfalls wird diese \emph{anisotrop} genannt.
\end{Definition}

\begin{Definition}
	Eine anisotrope Kante $\{X,Y\}$ wird \emph{Konstellation} genannt, wenn $G[X,Y]$ eine disjunkte Vereinigung von Sternen ist.
	Anderenfalls wird diese \emph{Co-Konstellation} genannt.
	Bei Co-Konstellationen bildet das \glslink{bipartites_komplement}{bipartite Komplement} von $G[X,Y]$ eine disjunkte Vereinigung von Sternen.
	Eine isotrope Kante dagegen wird entweder \emph{leer} oder \emph{vollständig} genannt.
\end{Definition}

\begin{Definition}
	 Ein Pfad $X_1X_2...X_l$ in $C(G)$, bei dem jede Kante $\{X_i,X_{i+1}\}$ anisotrop ist, wird \emph{anisotroper Pfad} genannt. Wenn dieser Pfad einen Kreis schließt, wird er als \emph{anisotroper Zyklus} bezeichnet. Gilt für einen anisotropen Pfad $|X_1|=|X_2|=...=|X_l|$ dann wird er \emph{gleichmäßig} genannt.
\end{Definition}

\subsection{Allgemeine globale Eigenschaften von CR-Graphen}
Mit dem so gewonnenen Hintergrundwissen kann nun das folgende Lemma formuliert werden, welches globale Eigenschaften von CR-Graphen definiert.

\begin{Lemma}
	Der Zellgraph $C(G)$ eines CR-Graphen $G$ erfüllt folgende Eigenschaften:

	\begin{enumerate}[label=(\Alph*)]
		\setcounter{enumi}{2}
		\item $C(G)$ enthält keinen gleichmäßigen, anisotropen Pfad, der zwei heterogene Zellen verbindet
		\item $C(G)$ enthält keinen gleichmäßigen, anisotropen Zyklus
		\item $C(G)$ enthält weder einen anisotropen Pfad $XY_1Y_2...Y_lZ$, sodass $|X|<|Y_1|=|Y_2|=...=|Y_l|>|Z|$, noch einen anisotropen Zyklus $XY_1Y_2...Y_l$, sodass $|X|<|Y_1|=|Y_2|=...=|Y_l|$ und die Zelle $Y_l$ heterogen ist
		\item $C(G)$ enthält keinen anisotropen Pfad $XY_1Y_2...Y_l$, sodass $|X|<|Y_1|=|Y_2|=...=|Y_l|$ und die Zelle $Y_l$ heterogen ist
	\end{enumerate}
	\label{lemma:global1}
\end{Lemma}

\emph{Beweis C:} Angenommen $P$ wäre, entgegen Bedingung \emph{C}, ein gleichmäßiger, anisotroper Pfad in $C(G)$, welcher die beiden anisotropen Komponenten $X$ und $Y$ verbindet.
Da es sich um einen gleichmäßigen Pfad handelt, besitzen sämtliche Komponenten auf dem Pfad die Kardinalität $k=|X|=|Y|$.
Alle Kanten in $P$, die eine Co-Konstellation bilden, werden nun komplementiert, sodass diese eine Konstellation ergeben.
Da nun sämtliche Kanten aus $P$ eine Konstellation darstellen und die Kardinalität aller Komponenten identisch ist, können die Sterne, welche die disjunkte Vereinigung für die Konstellationen bilden nur eine einzige Form annehmen.
Diese bestehen aus einem Zentralknoten und einem Blatt, wobei diese in unterschiedlichen Komponenten liegen.
Dadurch, dass sämtliche Kanten in $P$ diese Form annehmen, ergeben sich $k$ knotendisjunkte Pfade zwischen $X$ und $Y$.
Es sind also alle Knoten aus $X$ mit genau einem Knoten aus $Y$ durch einen Pfad verbunden und andersherum.
Sei $v\in X$ durch einen solchen Pfad mit seinem Gegenstück $v^*\in Y$ verbunden.
Der Pfad $P$ wird conducting genannt, wenn diese Abbildung von Knoten einen Isomorphismus von $G[X]$ auf $G[Y]$ darstellt.
Dazu müssen zwei Knoten $u,v\in X$ genau dann adjazent sein wenn ihre Gegenstücke $u^*,v^*\in Y$ adjazent sind.
Angenommen eine der beiden Komponenten ist matching und die andere ist co-matching, dann wird $P$ ebenfalls conducting genannt, wenn die Isomorphie zwischen der matching Komponente und dem Komplement der co-matching Komponente besteht.

Nachfolgend wird ein Graph $H$ erstellt werden, der nicht zu $G$ isomorph ist, welchen das Color Refinement allerdings nicht von $G$ unterscheiden kann.
Da $X$ und $Y$ heterogen sind, können die Kanten des Subgraphen $G[X]$ durch einen isomorphen aber unterschiedlichen Graphen mit der gleichen Knotenmenge $X$ ersetzt werden.
Ist $P$ in $G$ conducting, so muss $G[X]$ so ersetzt werden, dass der entstehende Pfad in $H$ nicht conducting ist, anderenfalls muss der entsprechende Pfad in $H$ conducting sein.
Ein Beispiel für ein solches Ersetzen von $G[X]$ findet sich in Abbildung \ref{fig:global_c}.
Dabei ist der durch die gestrichelten Linien dargestellte Pfad im Ausgangsgraphen links conducting und im modifizierten Graphen rechts nicht mehr, wodurch die Graphen nicht mehr isomorph sind.

\begin{figure}[t]
	\centering
	\begin{tikzpicture}
		\begin{scope}
			\node[main node] (1) {$1$};
			\node[main node] (2) [below left = 0.5cm and 0.85 of 1] {$2$};
			\node[main node] (3) [below = 1cm of 1] {$3$};
			\node[main node] (4) [right = 3cm of 1] {$4$};
			\node[main node] (5) [right = 3cm of 2] {$5$};
			\node[main node] (6) [right = 3cm of 3] {$6$};

			\path[draw,very thick]
			(1) edge node {} (3)
			(4) edge node {} (5);
			
			\path[draw,dashed]
			(1) edge node {} (4)
			(3) edge node {} (5);
			
			\node (ctrl) [below left = 1cm and 0.3cm of 3] {};			
			\draw[dashed] (2) .. controls (ctrl) .. (6);
			
			\node (fix circle) [right = -0.2cm of 5] {};
			\node[draw=red,dashed,fit=(4) (fix circle) (6),circle] (circle) {};
			
			\node[red] (text) [right = -1.2cm of circle] {$G[X]$};
		\end{scope}
		
		\begin{scope}[xshift=9cm]
			\node[main node] (1) {$1$};
			\node[main node] (2) [below left = 0.5cm and 0.85 of 1] {$2$};
			\node[main node] (3) [below = 1cm of 1] {$3$};
			\node[main node] (4) [right = 3cm of 1] {$4$};
			\node[main node] (5) [right = 3cm of 2] {$5$};
			\node[main node] (6) [right = 3cm of 3] {$6$};
			
			\path[draw,very thick]
			(1) edge node {} (3)
			(5) edge node {} (6);
			
			\path[draw,dashed]
			(1) edge node {} (4)
			(3) edge node {} (5);
			
			\node (ctrl) [below left = 1cm and 0.3cm of 3] {};			
			\draw[dashed] (2) .. controls (ctrl) .. (6);
		\end{scope}
	\end{tikzpicture}
	\caption{Beispiel für das Ersetzen eines Subgraphen in Lemma \ref{lemma:global1} \emph{C}}
	\label{fig:global_c}
\end{figure}

Lemma \ref{lemma:lokal_nicht_unterscheidbar} (a) besagt nun, dass der Color Refinement Algorithmus für $G$ und $H$ die gleiche Färbung errechnet und somit nicht zwischen den beiden unterscheiden kann.
Außerdem besagt Lemma \ref{lemma:faerbung_isomorphismus}, dass jeder Isomorphismus zwischen $G$ und $H$ Zellen auf sich selbst abbilden muss.
Da also gilt $\phi (v^*)=\phi (v)^*$, muss $\phi $ die Eigenschaft von $P$ erhalten conducting oder nicht zu sein, was in diesem konstruierten Beispiel nicht erfüllt ist.
Es folgt, dass $G$ und $H$ nicht isomorph sind und $G$ daher kein CR-Graph sein kann.\\

\emph{Beweis D:} Es wird wieder entgegen der Bedingung \emph{D} angenommen, dass $C(G)$ einen gleichmäßigen, anisotropen Zyklus $Q$ der Länge $m$ enthält.
Da dieser gleichmäßig ist, besitzen sämtliche Zellen in $Q$ die gleiche Kardinalität $k$.
Wie im Beweis von \emph{C} kann nun der Graph $G[A,B]$ für jede Co-Konstellation $\{A,B\}$ komplementiert werden, sodass ein Zyklus entsteht, welcher nur Konstellationen als Kanten enthält.
Ebenfalls wie im Beweis von \emph{C} gibt es eine eins zu eins Beziehung zwischen den Knoten zweier Benachbarter Komponenten, wodurch eine knotendisjunkte Vereinigung von Kreisen in $G$ entsteht.
Alle Kreise besitzen dabei ein Vielfaches der Länge $m$, wobei so im Extremfall ein Kreis der Länge $km$ oder $k$ Kreise der Länge $m$ vorliegen.

Durch die Anzahl der Kreise und deren Länge können die Isomorphieeigenschaften des entstehenden Subgraphen vollständig beschreiben, sodass der Isomorphietyp für den Zyklus $Q$ nachfolgend als $\tau (Q)$ bezeichnet wird.
Sei $\phi $ ein Isomorphismus von $G$ zu einem anderen Graphen $H$, so ist $\phi '$ der auf den Zellgraphen übertragene Isomorphismus von $C(G)$ zu $C(H)$.
Durch die Definition von $\tau $ ergibt sich, dass $\tau (\phi '(Q))=\tau (Q)$ gelten muss.
Intuitiv bedeutet dies, dass ein Kreis einer bestimmten Größe nur auf einen anderen Kreis abgebildet werden kann, welcher die selbe Größe besitzt.

Seien $X,Y\in Q$ zwei aufeinanderfolgende Zellen, so kann der dadurch entstehende Subgraph $G[X,Y]$ durch einen isomorphen aber nicht identischen Graphen ersetzt werden, da die Kante $\{X,Y\}$ anisotrop ist.
Somit entsteht ein neuer Graph $H$, welcher beispielsweise so konstruiert sein kann, dass für den betrachteten Zyklus die beiden eingangs erwähnten Extreme vorliegen.
Dadurch, dass sich hier zwei Möglichkeiten ergeben wie $\tau (Q)$ nach dem Austauschen aussehen kann, ist es möglich den Subgraphen $G[X,Y]$ so zu ersetzen, dass $\tau (Q)$ sich ändert.

Es wird wieder das Lemma \ref{lemma:lokal_nicht_unterscheidbar} genutzt, um zu zeigen, dass das Color Refinement nicht zwischen $G$ und $H$ unterschieden werden kann.
Außerdem ist $G$ nicht isomorph zu $H$, da sich $H$ so konstruieren lässt, dass $\tau (Q)$ in beiden Graphen unterschiedlich ist, wodurch der Graph $G$ nicht zu der Klasse der CR-Graphen gehören kann.\\

\emph{Beweis E:} Sei $P=XY_1Y_2...Y_lZ$ ein anisotroper Pfad in $G$, sodass dessen Kardinalitäten durch $|X|<|Y_1|=|Y_2|=...=|Y_l|>|Z|$ beschrieben werden.
Dabei sei es erlaubt, dass $X=Z$ ist und somit ein Kreis entsteht.
Für alle Kanten aus $P$, welche eine Co-Konstellation sind, wird im Folgenden das bipartite Komplement betrachtet, sodass sämtliche Kanten eine Konstellation bilden.
Somit stellen die Subgraphen $G[X,Y_1]=sK_{1,t}$ und $G[Z,Y_l]=aK_{1,b}$ mit $s,a,t,b\geq 2$ disjunkte Vereinigungen von Sternen dar.
Es folgt, dass $|X|=s, |Z|=a$ und $|Y_1|=|Y_l|=st=ab$ sind.
In dem Beweis zu Bedingung \emph{C} wurde bereits gezeigt, dass der gleichmäßige, anisotrope Pfad $Y_1Y_2...Y_l$ eine Abbildung der Knoten der Zellen $Y_1$ und $Y_l$ bildet, welche im Folgenden dazu verwendet wird die Identifikation $Y$ des gesamten Pfades zu bilden.
Der gesamte Pfad lässt sich zusammenfassen, indem $Y=Y_1=Y_l=\{1,2,...,st\}$ als Identifikation genutzt wird.
Diese lässt sich unterteilen, indem die Menge $Y_x$ für beliebige $x\in X$ die zu $x$ adjazenten Knoten in $Y$ beschreibt.
Eine ähnliche Menge $Y_z$ für alle $z\in Z$ lässt sich durch die zu $z$ adjazenten Knoten aus $Y$ bilden.
Daraus folgt, dass für beliebige $x\neq x'$ aus $X$ und $z\neq z'$ aus Z folgendes gilt:
\begin{displaymath}
	|Y_x|=t\text{, }|Y_z|=b\text{, }Y_x\cap Y_{x'}=\emptyset \text{ und }Y_z\cap Y_{z'}=\emptyset
\end{displaymath}
Die hier definierten Symbole werden in Abbildung \ref{fig:hypergraph1} beispielhaft dargestellt.

\begin{figure}[t]
	\centering
	\begin{tikzpicture}
		\begin{scope}
			\node[main node] (1) {$1$};
			\node[main node] (2) [below = 0.5cm of 1] {$2$};
			
			\node[main node] (3) [left = 3cm of 1] {$3$};
			\node[main node] (4) [above = 0.5cm of 3] {$4$};
			\node[main node] (5) [above = 0.5cm of 4] {$5$};
			\node[main node] (6) [below = 0.5cm of 3] {$6$};
			\node[main node] (7) [below = 0.5cm of 6] {$7$};
			\node[main node] (8) [below = 0.5cm of 7] {$8$};
			
			\node[main node] (9) [above left = 0.2cm and 3cm of 3] {$9$};
			\node[main node] (10) [below = 0.5cm of 9] {$10$};
			\node[main node] (11) [below = 0.5cm of 10] {$11$};

			\path[draw,thick]
			(2) edge node {} (6)
			(2) edge node {} (7)
			(2) edge node {} (8)
			(9) edge node {} (5)
			(9) edge node {} (3)
			(11) edge node {} (6)
			(11) edge node {} (8);
			
			\path[draw,thick,green]
			(10) edge node {} (4)
			(10) edge node {} (7);
			
			\path[draw,thick,red]
			(1) edge node {} (5)
			(1) edge node {} (4)
			(1) edge node {} (3);
			
			\node (X) [below = 0.2cm of 11] {$X=2K_{1,3}$};
			\node (Y) [below = 0.2cm of 8] {$Y$};
			\node (Z) [below = 0.2cm of 2] {$Z=3K_{1,2}$};
			
			\node[bezier] (tl5) [above left = 0.35cm and 0.1cm of 5] {};
			\node[bezier] (tr5) [above right = 0.35cm and 0.1cm of 5] {};
			\node[bezier] (l5) [left = 0.1cm of 5] {};
			\node[bezier] (r5) [right = 0.1cm of 5] {};
			
			\node[bezier] (l3) [left = 0.1cm of 3] {};
			\node[bezier] (r3) [right = 0.1cm of 3] {};
			\node[bezier] (bl3) [below left = 0.35cm and 0.1cm of 3] {};
			\node[bezier] (br3) [below right = 0.35cm and 0.1cm of 3] {};
			
			\draw[very thick,dotted,red] (l5) .. controls (tl5) and (tr5) .. (r5)
			(r5) -- (r3)
			(r3) .. controls (br3) and (bl3) .. (l3)
			(l3) -- (l5);
			
			
			\node[bezier] (tr7) [above right = 0.1cm and 0.35cm of 7] {};
			\node[bezier] (br7) [below right = 0.1cm and 0.35cm of 7] {};
			\node[bezier] (t7) [above = 0.1cm of 7] {};
			\node[bezier] (b7) [below = 0.1cm of 7] {};
			
			\node[bezier] (tl7) [left = 0.5cm of t7] {};
			\node[bezier] (bl6) [below left = 0.1cm and 0.35cm of 6] {};
			
			\node[bezier] (tr4) [above right = 0.1cm and 0.35cm of 4] {};
			\node[bezier] (br4) [below right = 0.1cm and 0.35cm of 4] {};
			\node[bezier] (t4) [above = 0.1cm of 4] {};
			\node[bezier] (b4) [below = 0.1cm of 4] {};
			
			\node[bezier] (bl4) [left = 0.5cm of b4] {};
			\node[bezier] (tl3) [above left = 0.1cm and 0.35cm of 3] {};
			
			\node[bezier] (tlx1) [left = 0.7cm of t4] {};
			\node[bezier] (tlx2) [below left = 0.1cm and 0.4cm of tlx1] {};
			\node[bezier] (tlx3) [below left = 0.5cm and 0.5cm of tlx1] {};
			
			\node[bezier] (blx1) [left = 0.7cm of b7] {};
			\node[bezier] (blx2) [above left = 0.1cm and 0.4cm of blx1] {};
			\node[bezier] (blx3) [above left = 0.5cm and 0.5cm of blx1] {};
			
			\draw[very thick,dashed,green] 
			(b7) -- (blx1)
			(blx1) .. controls (blx2) .. (blx3)
			(blx3) -- (tlx3)
			(tlx3) .. controls (tlx2) .. (tlx1)
			(tlx1) -- (t4)
			(t4) .. controls (tr4) and (br4) .. (b4)
			(b4) .. controls (bl4) .. (tl3)
			(tl3) -- (bl6)
			(bl6) .. controls (tl7) .. (t7)
			(t7) .. controls (tr7) and (br7) .. (b7);
			
			\node (Yx) [green, right = 1.3cm of 10] {$Y_x$};
			\node (Yz) [red, right = 0.1cm of 5] {$Y_z$};
			
			\node (text1) [below = 1cm of 8] {$s=2$, $t=3$, $a=3$, $b=2$};
			\node (text2) [below = 0.2cm of text1] {$|X|=s=2$, $|Z|=a=3$, $Y_1|=|Y_l|=|Y|=st=ab=6$};
			\node (text3) [below = 0.2cm of text2] {$|Y_x|=t=3$, $|Y_z|=b=2$};
		\end{scope}
	\end{tikzpicture}
	\caption{Beispiel für die Darstellung der im Beweis für Bedingung \emph{C} eingeführten Symbole}
	\label{fig:hypergraph1}
\end{figure}


Es wird nun der \gls{hypergraph} $\mathcal{Y}_G$ auf den Knoten von $Y$ gebildet. 
Dabei wird für jedes $x\in X$ und $z\in Z$ eine Hyperkante aus der Knotenmenge von $Y_x$ beziehungsweise $Y_z$ erstellt, wodurch sich die gesamte Kantenmenge durch $\{Y_x\}_{x\in X}\cup \{Y_z\}_{z\in Z}$ zusammensetzt.
Zwei dieser Hyperkanten sind in Abbildung \ref{fig:hypergraph1} beispielhaft eingetragen, der Graph enthält selbstverständlich aber noch weitere.
Falls für irgendwelche $x$ und $z$ die Mengen $Y_x$ und $Y_z$ identisch sind, so enthält dieser Graph auch Mehrfachkanten.
Der ursprünglich betrachtete Pfad $P$ wird \emph{flach} genannt, sofern kein Paar $(x,z)\in X\times Y$ existiert, sodass keine der entsprechenden Hyperkanten $Y_x$ und $Y_z$ die andere enthält.
Es werden nun die Knoten in $Y$ so umsortiert, dass die Hyperkanten $\{Y_z\}_{z\in Z}$ aufeinanderfolgende Intervalle beschreiben, was in dem abgebildeten Beispiel bereits optisch so dargestellt wurde.

Es wird nun wieder ein zu $G$ nicht isomorpher Graph $H$ gebildet, welcher vom Color Refinement nicht von diesem unterschieden werden kann.
Ist $P$ in $G$ flach, wird $H$ so konstruiert, dass der Pfad $P$ nicht mehr flach ist.
Dies ist möglich, indem die Kanten des Subgraphen $G[X,Y_1]$ durch einen isomorphen aber anderen Subgraphen ersetzt werden, sodass die in $\mathcal{Y}_H$ gebildeten Hyperkanten in aufeinanderfolgenden Intervallen stehen.
Formal wird also $\mathcal{Y}_H=\{Y_i\}_{i\in [s]}\cup \{Y_z\}_{z\in Z}$ mit $Y_i=\{(i-1)t+1,2,...,it\}$ definiert.
Der Pfad $P$ ist somit nicht mehr flach, da sowohl wie vorher beschrieben die Hyperkanten $\{Y_z\}_{z\in Z}$, als auch die Hyperkanten $\{Y_x\}_{x\in X}$ in aufeinanderfolgender Reihenfolge in $Y$ liegen, wodurch sichergestellt ist, dass immer ein $(x,z)$ existiert, sodass eine der entsprechenden Hyperkanten die andere einschließt.
Für das vorgestellte Beispiel ist in Abbildung \ref{fig:hypergraph2} diese Erweiterung mit einem ersetzten Subgraphen $G[X,Y_1]$, sowie den Hyperkanten $\{Y_x\}$ in grün und $\{Y_z\}$ in rot zu sehen.
Es ist erkennbar, dass einige der Mengen von $\{Y_x\}$ vollständig in einer Menge von $\{Y_z\}$ ligen, womit der Pfad nicht mehr flach ist.

\begin{figure}[t]
	\centering
	\begin{tikzpicture}
		\begin{scope}
			\node[main node] (1) {$1$};
			\node[main node] (2) [below = 0.5cm of 1] {$2$};
			
			\node[main node] (3) [left = 3cm of 1] {$3$};
			\node[main node] (4) [above = 0.5cm of 3] {$4$};
			\node[main node] (5) [above = 0.5cm of 4] {$5$};
			\node[main node] (6) [below = 0.5cm of 3] {$6$};
			\node[main node] (7) [below = 0.5cm of 6] {$7$};
			\node[main node] (8) [below = 0.5cm of 7] {$8$};
			
			\node[main node] (9) [above left = 0.2cm and 3cm of 3] {$9$};
			\node[main node] (10) [below = 0.5cm of 9] {$10$};
			\node[main node] (11) [below = 0.5cm of 10] {$11$};
			
			\path[draw,thick,red]
			(1) edge node {} (5)
			(1) edge node {} (4)
			(1) edge node {} (3)
			(2) edge node {} (6)
			(2) edge node {} (7)
			(2) edge node {} (8);
			
			\path[draw,thick,green]
			(9) edge node {} (5)
			(9) edge node {} (4)
			(10) edge node {} (3)
			(10) edge node {} (6)
			(11) edge node {} (7)
			(11) edge node {} (8);
			
			\node (X) [below = 0.2cm of 11] {$X$};
			\node (Y) [below = 0.2cm of 8] {$Y$};
			\node (Z) [below = 0.2cm of 2] {$Z$};
			
			\node[bezier] (tl5) [above left = 0.35cm and 0.1cm of 5] {};
			\node[bezier] (tr5) [above right = 0.35cm and 0.1cm of 5] {};
			\node[bezier] (l5) [left = 0.1cm of 5] {};
			\node[bezier] (r5) [right = 0.1cm of 5] {};
			
			\node[bezier] (l3) [left = 0.1cm of 3] {};
			\node[bezier] (r3) [right = 0.1cm of 3] {};
			\node[bezier] (bl3) [below left = 0.35cm and 0.1cm of 3] {};
			\node[bezier] (br3) [below right = 0.35cm and 0.1cm of 3] {};
			
			\draw[very thick,dotted,red] (l5) .. controls (tl5) and (tr5) .. (r5)
			(r5) -- (r3)
			(r3) .. controls (br3) and (bl3) .. (l3)
			(l3) -- (l5);
			
			\node[bezier] (tl6) [above left = 0.35cm and 0.1cm of 6] {};
			\node[bezier] (tr6) [above right = 0.35cm and 0.1cm of 6] {};
			\node[bezier] (l6) [left = 0.1cm of 6] {};
			\node[bezier] (r6) [right = 0.1cm of 6] {};
			
			\node[bezier] (l8) [left = 0.1cm of 8] {};
			\node[bezier] (r8) [right = 0.1cm of 8] {};
			\node[bezier] (bl8) [below left = 0.35cm and 0.1cm of 8] {};
			\node[bezier] (br8) [below right = 0.35cm and 0.1cm of 8] {};
			
			\draw[very thick,dotted,red] (l6) .. controls (tl6) and (tr6) .. (r6)
			(r6) -- (r8)
			(r8) .. controls (br8) and (bl8) .. (l8)
			(l8) -- (l6);
			
			\node[bezier] (tl52) [above left = 0.45cm and 0.2cm of 5] {};
			\node[bezier] (tr52) [above right = 0.45cm and 0.2cm of 5] {};
			\node[bezier] (l52) [left = 0.2cm of 5] {};
			\node[bezier] (r52) [right = 0.2cm of 5] {};
			
			\node[bezier] (l42) [left = 0.2cm of 4] {};
			\node[bezier] (r42) [right = 0.2cm of 4] {};
			\node[bezier] (bl42) [below left = 0.45cm and 0.2cm of 4] {};
			\node[bezier] (br42) [below right = 0.45cm and 0.2cm of 4] {};
			
			\draw[very thick,dashed,green] (l52) .. controls (tl52) and (tr52) .. (r52)
			(r52) -- (r42)
			(r42) .. controls (br42) and (bl42) .. (l42)
			(l42) -- (l52);
			
			\node[bezier] (tl32) [above left = 0.45cm and 0.2cm of 3] {};
			\node[bezier] (tr32) [above right = 0.45cm and 0.2cm of 3] {};
			\node[bezier] (l32) [left = 0.2cm of 3] {};
			\node[bezier] (r32) [right = 0.2cm of 3] {};
			
			\node[bezier] (l62) [left = 0.2cm of 6] {};
			\node[bezier] (r62) [right = 0.2cm of 6] {};
			\node[bezier] (bl62) [below left = 0.45cm and 0.2cm of 6] {};
			\node[bezier] (br62) [below right = 0.45cm and 0.2cm of 6] {};
			
			\draw[very thick,dashed,green] (l32) .. controls (tl32) and (tr32) .. (r32)
			(r32) -- (r62)
			(r62) .. controls (br62) and (bl62) .. (l62)
			(l62) -- (l32);
			
			\node[bezier] (tl72) [above left = 0.45cm and 0.2cm of 7] {};
			\node[bezier] (tr72) [above right = 0.45cm and 0.2cm of 7] {};
			\node[bezier] (l72) [left = 0.2cm of 7] {};
			\node[bezier] (r72) [right = 0.2cm of 7] {};
			
			\node[bezier] (l82) [left = 0.2cm of 8] {};
			\node[bezier] (r82) [right = 0.2cm of 8] {};
			\node[bezier] (bl82) [below left = 0.45cm and 0.2cm of 8] {};
			\node[bezier] (br82) [below right = 0.45cm and 0.2cm of 8] {};
			
			\draw[very thick,dashed,green] (l72) .. controls (tl72) and (tr72) .. (r72)
			(r72) -- (r82)
			(r82) .. controls (br82) and (bl82) .. (l82)
			(l82) -- (l72);
		\end{scope}
	\end{tikzpicture}
	\caption{Erweiterung des Beispiels, sodass der Pfad nicht mehr flach ist}
	\label{fig:hypergraph2}
\end{figure}

Ist $P$ in $G$ allerdings nicht flach, so wird der Subgraph $G[X,Y_1]$ in $H$ so ersetzt, dass der entsprechende Pfad $P$ in $H$ flach wird.
Formal ist also $Y_i=\{i,i+s,...,i+(t-1)s\}$.

$H$ ist somit in der Tat nicht zu $G$ isomorph, da für diese Eigenschaft der Pfad $P$ in beiden Graphen entweder flach oder in beiden Graphen nicht flach sein müsste.
Aus Teil (a) von Lemma \ref{lemma:lokal_nicht_unterscheidbar} folgt außerdem, dass das Color Refinement die beiden Graphen nicht unterscheiden kann, wodurch klar ist, dass der Graph $G$ kein CR-Graph sein kann.\\

\emph{Beweis F:} Dieser Beweis läuft ähnlich wie der von Bedingung \emph{E} ab, weshalb sich viele Parallelen erkennen lassen.
Sei $P=XY_1Y_2...Y_l$ ein anisotroper Pfad in $C(G)$, wobei die Kardinalitäten der Zellen dem Schema $|X|<|Y_1|=|Y_2|=...=|Y_l|$ folgen und $Y_l$ heterogen ist.
Für alle Kanten des Pfades, welche eine Co-Konstellation sind, wird im Folgenden wieder das Komplement betrachtet.
Es sei $G[X,Y_1]=sK_{1,t}$ eine disjunkte Vereinigung von Sternen mit $s,t\geq 2$ und $|Y_1|=st$, wodurch $Y_l$ nur gerade Kardinalität haben kann.
Nach Lemma \ref{lemma:lokal} \emph{A} kann $Y_l$ nur ein Matching Graph oder dessen Komplement sein, in welchem Falle ab sofort das Komplement von $Y_l$ betrachtet wird.
Dies ist der Fall, da auszuschließen ist, dass der heterogene Knoten nicht vollständig oder leer sein kann und ein 5er \gls{zyklus} ebenfalls nicht möglich ist, da $Y_l$ gerade Kardinalität hat.

Es wird nun wie im Beweis von \emph{E} die Identität $Y=Y_1=Y_l=\{1,2,...,st\}$ gebildet.
Außerdem wird der Hypergraph $\mathcal{Y}_G=\{Y_x\}_{x\in X}\cup \mathcal{E}$ erstellt, wobei $\{Y_x\}$ wieder die Menge der zu $x\in X$ adjazenten Knoten in $Y$ und $\mathcal{E}$ die Menge der Paare aus $G[Y_l]$, welche durch eine Matching-Kante verbunden sind, definiert.

Nun kann wie im Beweis von Bedingung \emph{E} der Isomorphietyp von $\mathcal{Y}_G$ verändert werden, indem die Kanten von $G[X,Y_1]$ durch einen isomorphen aber anderen Graphen ersetzt werden.
Somit kann ein zu $G$ nicht isomorpher Graph $H$ erzeugt werden, welcher aber nach Lemma \ref{lemma:lokal_nicht_unterscheidbar} nicht durch das Color Refinement von diesem unterschieden werden kann.

\subsection{Baumartige Struktur von CR-Graphen}
Bei genauerer Betrachtung fällt auf, dass der Zellgraph von CR-Graphen eine baumartige Struktur aufweist.
Dies lässt sich schon daraus erahnen, dass Bedingung \emph{D} und \emph{E} zusammen verbieten, dass in einem Subgraphen mit ausschließlich anisotropen Kanten, keine Kreise erlaubt sind und somit eine Baumstruktur erkennbar ist.
Um das folgende Lemma verstehen zu können, welches diese Baumstruktur genauer spezifiziert, wird der Begriff \emph{anisotrope Komponente} benötigt.
\begin{Definition}
	In einem Zellgraphen $C(G)$ bezeichnet eine \emph{anisotrope Komponente} einen Subgraphen, dessen Kanten alle anisotrop sind.
	Wenn eine Zelle keine inzidente, anisotrope Kante besitzt, dann ergibt sich daraus eine anisotrope Komponente mit nur einer Zelle.
\end{Definition}

\begin{Lemma}
	Angenommen ein CR-Graph $G$ erfüllt die Bedingungen \emph{A-F} aus den Lemmata \ref{lemma:lokal} und \ref{lemma:global1}.
	Für jede anisotrope Komponente $A$ von $C(G)$ gelten folgende Eigenschaften:
	
	\begin{enumerate}[label=(\Alph*)]
		\setcounter{enumi}{6}
		\item $A$ ist ein Baum, der folgende Monotonieeigenschaft erfüllt: Sei $R$ eine Zelle aus $A$ mit minimaler Kardinalität, so ist $A_R$ der gerichtete Baum mit Wurzel $R$; Für jede gerichtete Kante $(X,Y)$ aus $A_R$ gilt dann $|X|\leq |Y|$
		\item $A$ enthält maximal eine heterogene Zelle; Wenn eine solche Zelle existiert, hat diese minimale Kardinalität in $A$
	\end{enumerate}
	\label{lemma:global2}
\end{Lemma}

\emph{Beweis G:} Wegen Bedingung \emph{D} kann $A$ keinen gleichmäßigen, anisotropen Zyklus enthalten und das Vorkommen sämtlicher anderer anisotroper Zyklen wird durch Bedingung \emph{E} ausgeschlossen. Außerdem folgt aus \emph{E} die Monotonieeigenschaft.\\

\emph{Beweis H:} Angenommen es gäbe zwei heterogene Zellen $S$ und $T$ in $A$, dann sei $S=Z_1,Z_2,...,Z_l=T$ der Pfad, welcher die beiden verbindet.
Wegen der Monotonieeigenschaft von Bedingung \emph{G} gibt es ein $j$, sodass $|Z_1|\geq ... \geq |Z_j|\leq ... \leq |Z_l|$ gilt, wobei außerdem $j\in \{1,l\}$ erlaubt ist.
Dabei stellt $Z_j$ die Wurzel des in \emph{G} beschriebenen Baumes dar.
Durch Bedingung \emph{C} ist außerdem ausgeschlossen, dass dieser Pfad gleichmäßig ist, weshalb mindestens eine der Ungleichungen strikt sein muss.
Die Existenz eines so geformten Pfades ist allerdings durch Bedingung \emph{F} ausgeschlossen.

Nun bleibt noch zu zeigen, dass eine heterogene Zelle $R$ in $A$ minimale Kardinalität innerhalb von $A$ besitzt.
Im Folgenden wird dazu ein Pfad $R=Z_1,Z_2,...,Z_l=S$ betrachtet, welcher $R$ mit der Zelle $S$ verbindet, welche minimale Kardinalität in $A$ besitzt.
Ebenfalls aus Bedingung \emph{F} und durch die Monotonieegenschaft von Bedingung \emph{G} folgt, dass dieser Pfad gleichmäßig sein muss, weshalb $|R|=|S|$ gelten muss und $R$ damit ebenfalls eine Zelle minimaler Kardinalität ist.